<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Comparing a code based problem solving approach to using a spreadsheet">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Calculations with Python Code or Excel Spreadsheets | ifcuriousthenlearn</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://nagordon.github.io/ifcuriousthenlearn/blog/pythoncode-vs-excel/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="neal">
<link rel="prev" href="../sage-embed/" title="Sage Math Tool" type="text/html">
<link rel="next" href="../brick-stacking/" title="An investigation of the Brick Stacking Problem" type="text/html">
<meta property="og:site_name" content="ifcuriousthenlearn">
<meta property="og:title" content="Calculations with Python Code or Excel Spreadsheets">
<meta property="og:url" content="https://nagordon.github.io/ifcuriousthenlearn/blog/pythoncode-vs-excel/">
<meta property="og:description" content="Comparing a code based problem solving approach to using a spreadsheet">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-08-20T00:00:00-07:00">
<meta property="article:tag" content="excel">
<meta property="article:tag" content="python">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://nagordon.github.io/ifcuriousthenlearn/">

                <span id="blog-title">ifcuriousthenlearn</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../index.html">Home</a>
                </li>
<li>
<a href="../../archive.html">Blog</a>
                </li>
<li>
<a href="../../about/index.html">About</a>
                </li>
<li>
<a href="../../categories/index.html">Tags</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.ipynb" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Calculations with Python Code or Excel Spreadsheets</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    neal
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2016-08-20T00:00:00-07:00" itemprop="datePublished" title="2016-08-20 00:00">2016-08-20 00:00</time></a>
            </p>
            
        <p class="sourceline"><a href="index.ipynb" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="To-code-or-not-to-code">To code or not to code<a class="anchor-link" href="#To-code-or-not-to-code">¶</a>
</h2>
<p>When faced with a technical challenge or problem solving, conceptual understanding is an important first step, and I almost always start with hand calculations. Once I feel that I have a grasp of the concept, then I turn to a digital approach which often involves using excel or python and running some numbers, and re-running them, and fiddling until I really understand. I always feel like, especially in engineering, that using the right tool for the right job can make a big difference in the results. <a href="https://products.office.com/en-us/excel">Microsoft Excel</a> or <a href="https://www.libreoffice.org/discover/calc/">Libre Calc</a> spreadsheet programs are a great way to plug some numbers in and perform simple calculations with nearly no learning curve to get an answer. But as the complexity and quantity of the data and compuation increases, spreadsheets start to not make sense. That's where I feel a code based calculation method is important tool in everyones analysis toolbox. Classicaly, good old pencil and paper was the only way to model and work out problems. But, with the availability of the personal computer, software has allowed us to do more work with less effort. I find it very fascinating to see how people solve problems. This post will explore that idea and hopefully give you an idea to go beyond excel the next time you need to run some numbers.</p>
<p>There are many ways to solve engineering problems. The main tools that I have found critical  are:</p>
<ul>
<li>
<strong>hand calculations</strong>  <ul>
<li>no learning curve</li>
<li>low cost</li>
<li>slow, tedious and can be error prone (me and algebra :( )</li>
<li>forces you to understand </li>
</ul>
</li>
<li>
<strong>spreadsheets</strong>  <ul>
<li>medium learning curve</li>
<li>great at simple data storage</li>
<li>great for simple calcualtions</li>
<li>non-linear / confusing thought process</li>
<li>not great at large scale date storage </li>
<li>not repeatable</li>
</ul>
</li>
<li>
<strong>code</strong>  <ul>
<li>linear thought process (usually)</li>
<li>most powerful for calculations </li>
<li>not great at simple data storage</li>
<li>great for large scale data storage and processing </li>
<li>powerful version control (<a href="https://git-scm.com/">git</a>)</li>
<li>very repeatable</li>
</ul>
</li>
</ul>
<p>These are a few methods for solving computational problems. Each one has a time and place, but recognizing when you are trying to put a square peg in a round hole can help keep you sane.</p>
<h2 id="An-Example---python-and-Excel-to-understand-loans">An Example - python and Excel to understand loans<a class="anchor-link" href="#An-Example---python-and-Excel-to-understand-loans">¶</a>
</h2>
<p>OK, so we discussed some different approaches to problem solving. Lets look at an example of using an spreadsheet and python code to understand and determine the cost of an loan. Some terms are listed below if you aren't familiar with a compound interest loan.</p>
<blockquote>
<p>apr - annual percentage rate<br>
r   - monthly percentge rate, apr/12<br>
per - the peroid for which you want to find an interest<br>
nper - number of payment<br>
pv - present value, the loan amount
pmt - payment for a loan<br>
payments due at the end of the period</p>
</blockquote>
<p>Let's throw some numbers at this. Here I will define some variables that define our loan parameters</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">############# define input variables #############</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">24</span>   <span class="c1"># term in months</span>
<span class="n">apr</span> <span class="o">=</span> <span class="mf">0.0250</span>   <span class="c1"># annual percentage rate</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">apr</span><span class="o">/</span><span class="mi">12</span>     <span class="c1"># monthly percentage rate</span>
<span class="n">baseloan</span> <span class="o">=</span> <span class="mi">30000</span>   <span class="c1"># principal amount of loan</span>
<span class="n">downpayment</span> <span class="o">=</span> <span class="mi">5000</span> 
<span class="n">PV</span> <span class="o">=</span> <span class="n">baseloan</span> <span class="o">-</span> <span class="n">downpayment</span>  <span class="c1"># present value of the loan</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Hand-Calculation">Hand Calculation<a class="anchor-link" href="#Hand-Calculation">¶</a>
</h3>
<p>If we are to hand calculate our loan payments, we can use the following equation (found in Engineering Economy, Blank et al, pg 58)</p>
$$
payment = PV \bigg[  \frac{r(1+r)^n}{(1+r)^n-1} \bigg]
$$
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># monthly payments assuming compounding interest</span>
<span class="n">payment</span> <span class="o">=</span> <span class="o">-</span><span class="n">PV</span><span class="o">*</span><span class="p">((</span><span class="n">r</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">payment</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>-1069.0098055421547</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Easy enough, but what if you want to make a payment table, it would be very tedious by hand. Fortuantley, we have a computer. Since I understand the equation being used, I have no issues with automating this a little more. We can make an spreadsheet table. which is nice visually, didn't take very much time, and allows me to change some parameters.</p>
<p><strong>Update</strong> - I found out that Excel has a great Loan Amortization spreadsheet built in, and it even includes early payoff, which is not that easy to calculate. I have included it in the spreadsheet below or you can make a new one by doing the following.</p>
<blockquote>
<p><em>right-click on a new sheet -&gt; Insert -&gt; Spreadsheet Solutions -&gt; Loan Amortization</em></p>
</blockquote>
<h3 id="Spreadsheet">Spreadsheet<a class="anchor-link" href="#Spreadsheet">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<iframe width="700" height="807" frameborder="0" scrolling="no" src="https://onedrive.live.com/embed?cid=2DAE54F5236205EE&amp;resid=2DAE54F5236205EE%2125844&amp;authkey=AMSdq_7Zcg_mK_g&amp;em=2&amp;wdAllowInteractivity=False&amp;AllowTyping=True&amp;ActiveCell='loan'!E2&amp;Item='loan'!A1%3AI38&amp;wdHideGridlines=True&amp;wdDownloadButton=True"></iframe>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>But, if we want to change, say the term length, well then we have to change the layout of the table and mess with it, so the spreadsheet isn't as robust as we had hoped. How about a code solution? Here are the steps to get some python code going to do the same exact calcuation, and being very robust, and can be used for many different finanical applications.</p>
<h3 id="Code">Code<a class="anchor-link" href="#Code">¶</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">############# import python libraries #############</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">date_range</span><span class="p">,</span> <span class="n">set_option</span><span class="p">,</span> <span class="n">options</span>
<span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">'$</span><span class="si">{:10,.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">############# calculate output #############</span>
<span class="n">per</span> <span class="o">=</span>              <span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># months</span>
<span class="n">payment</span> <span class="o">=</span>          <span class="n">pmt</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">PV</span><span class="p">)</span>  <span class="c1"># monthly payment</span>
<span class="n">interestpayment</span> <span class="o">=</span>  <span class="n">ipmt</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">PV</span><span class="p">)</span>  <span class="c1"># monthly interest</span>
<span class="n">principalpayment</span> <span class="o">=</span> <span class="n">ppmt</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">per</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">PV</span><span class="p">)</span>  <span class="c1"># monthly principal</span>
<span class="n">balance</span> <span class="o">=</span>          <span class="n">PV</span> <span class="o">+</span> <span class="n">per</span><span class="o">*</span><span class="n">payment</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">interestpayment</span><span class="p">)</span> <span class="c1"># monthly balance</span>
<span class="n">dates</span> <span class="o">=</span>            <span class="n">date_range</span><span class="p">(</span><span class="s1">'20160101'</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">'M'</span><span class="p">)</span>

<span class="c1">############# create a table with the output #############</span>
<span class="c1"># create a dataframe for simple data management and output</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s1">'date'</span><span class="p">:</span><span class="n">dates</span><span class="p">,</span>
                <span class="s1">'month'</span><span class="p">:</span><span class="n">per</span><span class="p">,</span>
                <span class="s1">'balance'</span><span class="p">:</span><span class="n">balance</span><span class="p">,</span>
                <span class="s1">'payment'</span><span class="p">:</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">per</span><span class="p">))</span><span class="o">*</span><span class="n">payment</span><span class="p">,</span>
                <span class="s1">'interest'</span><span class="p">:</span><span class="n">interestpayment</span><span class="p">,</span>
                <span class="s1">'principal'</span><span class="p">:</span><span class="n">principalpayment</span><span class="p">})</span>
<span class="c1"># reorder the columns to match the spreadsheet</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">'date'</span><span class="p">,</span><span class="s1">'month'</span><span class="p">,</span><span class="s1">'balance'</span><span class="p">,</span><span class="s1">'payment'</span><span class="p">,</span><span class="s1">'interest'</span><span class="p">,</span><span class="s1">'principal'</span><span class="p">]]</span>

<span class="c1">############# print output #############</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">' monthly payment     = </span><span class="si">%f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">payment</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">' total interest cost = </span><span class="si">%f</span><span class="se">\n</span><span class="s1">'</span> <span class="o">%</span> <span class="nb">sum</span><span class="p">(</span><span class="n">interestpayment</span><span class="p">))</span>   
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre> monthly payment     = -1069.009806
 total interest cost = -656.235333

         date  month     balance     payment    interest   principal
0  2016-01-31      1 $ 24,587.23 $ -1,069.01 $    -52.08 $ -1,016.93
1  2016-02-29      2 $ 23,518.22 $ -1,069.01 $    -49.96 $ -1,019.05
2  2016-03-31      3 $ 22,449.21 $ -1,069.01 $    -47.84 $ -1,021.17
3  2016-04-30      4 $ 21,380.20 $ -1,069.01 $    -45.71 $ -1,023.30
4  2016-05-31      5 $ 20,311.19 $ -1,069.01 $    -43.58 $ -1,025.43
5  2016-06-30      6 $ 19,242.18 $ -1,069.01 $    -41.45 $ -1,027.56
6  2016-07-31      7 $ 18,173.17 $ -1,069.01 $    -39.31 $ -1,029.70
7  2016-08-31      8 $ 17,104.16 $ -1,069.01 $    -37.16 $ -1,031.85
8  2016-09-30      9 $ 16,035.15 $ -1,069.01 $    -35.01 $ -1,034.00
9  2016-10-31     10 $ 14,966.14 $ -1,069.01 $    -32.86 $ -1,036.15
10 2016-11-30     11 $ 13,897.13 $ -1,069.01 $    -30.70 $ -1,038.31
11 2016-12-31     12 $ 12,828.12 $ -1,069.01 $    -28.53 $ -1,040.48
12 2017-01-31     13 $ 11,759.11 $ -1,069.01 $    -26.37 $ -1,042.64
13 2017-02-28     14 $ 10,690.10 $ -1,069.01 $    -24.19 $ -1,044.82
14 2017-03-31     15 $  9,621.09 $ -1,069.01 $    -22.02 $ -1,046.99
15 2017-04-30     16 $  8,552.08 $ -1,069.01 $    -19.84 $ -1,049.17
16 2017-05-31     17 $  7,483.07 $ -1,069.01 $    -17.65 $ -1,051.36
17 2017-06-30     18 $  6,414.06 $ -1,069.01 $    -15.46 $ -1,053.55
18 2017-07-31     19 $  5,345.05 $ -1,069.01 $    -13.27 $ -1,055.74
19 2017-08-31     20 $  4,276.04 $ -1,069.01 $    -11.07 $ -1,057.94
20 2017-09-30     21 $  3,207.03 $ -1,069.01 $     -8.86 $ -1,060.15
21 2017-10-31     22 $  2,138.02 $ -1,069.01 $     -6.65 $ -1,062.36
22 2017-11-30     23 $  1,069.01 $ -1,069.01 $     -4.44 $ -1,064.57
23 2017-12-31     24 $      0.00 $ -1,069.01 $     -2.22 $ -1,066.79
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Assuming the user has a basic understanding of how to write a computer program, code is(should be) very straightforward to read. Spreadsheets, like the one shown above can be nebulus and requires a fair bit of digging to see what calcualtions are being made. 
If you need any help with the functions, use the help function to show the inputs</p>
<div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmt</span><span class="p">)</span>
<span class="n">help</span><span class="p">(</span><span class="n">ipmt</span><span class="p">)</span>
<span class="n">help</span><span class="p">(</span><span class="n">ppmt</span><span class="p">)</span>
</pre></div>
<p>Try playing around with the code and see what happens when the terms of the loan are changed. The code is more robust to changes, where the spreadsheet has to be reworked</p>
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a>
</h2>
<p>A simple demo compared spreadsheets versus code with an example of a common calcualtion problem, loans! When pursuing future projects, think about what tools would be the best for the given problem, as well as you, and possibly your team.</p>
<p>Stay curious!</p>

</div>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/excel/" rel="tag">excel</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../sage-embed/" rel="prev" title="Sage Math Tool">Previous post</a>
            </li>
            <li class="next">
                <a href="../brick-stacking/" rel="next" title="An investigation of the Brick Stacking Problem">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2021         <a href="mailto:">neal</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         copyright Neal Gordon
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
